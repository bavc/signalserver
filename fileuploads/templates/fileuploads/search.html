{% include 'base.html' %}
{% block content %}
<span>
    <div class = "container-fluid">
        <h1>File Search and Group Creation</h1>
        <h4>Based on the result of file search, we can create the group in this page.</h4>

        <div class="row">
            <div class="col-md-6">
                    <h3> All uploaded files </h3>
                    {% if files %}
                    {% for file in files %}
                            <li>{{ file.filename }}
                                 <ul> Uploaded time : {{file.upload_time}}</ul>
                            </li>
                        {% endfor %}
                        </ul>
                    {% else %}
                        <p>No file.</p>
                    {% endif %}

            </div>
            <div class="col-md-6">
                    <form action="{% url 'fileuploads:search' %}" name = "search" method="post" class="form">
                    {% csrf_token %}

                    <h3>File Search</h3>
                    <p>Start Time: <input name='start_field' type="text" id="datetimepicker"></p>
                    <p>End Time: <input name='end_field' type="text" id="datetimepicker2"></p>

                    <p>Exact file name or keyword in the filename (case sensitive): </p>
                    <p><input name='keyword' type="text" id="keyword"></p>
                    <button type="search" class="btn btn-primary">
                        Search
                    </button>
                    </form>
                    {% if videos %}
                        <h3> Search Results </h3>
                            <form action="{% url 'groups:save_group' %}" name="group_name" method="post" enctype="multipart/form-data">
                            <h4> Search keywords </h4>
                            {% if start %}
                                <input type="hidden" name="start" id="start" value="{{ start }}" />
                                <h4> Start time : {{ start}}
                            {% endif %}
                            {% if end %}
                                <input type="hidden" name="end" id="end" value="{{ end }}" />
                                End time : {{ end }}
                            {% endif %}
                            {% if keyword %}
                                The filename has a word : {{ keyword }} </h4></br></br>
                            {% endif %}


                            <ul>
                            {% csrf_token %}
                            {% for video in videos %}
                                <li><input type="hidden" name="file{{ forloop.counter }}" id="file{{ forloop.counter }}" value="{{ video.filename }}" />
                                {{ video.filename }}
                                <ul>Uploaded time : {{video.upload_time}}</ul>
                                </li>
                            {% endfor %}
                            </ul>

                            {% if message %}
                                {{ message }}
                            {% endif %}
                            {% if form %}
                                {% csrf_token %}
                                <p>{{ form.non_field_errors }}</p>
                                <p>{{ form.group_name.label_tag }}{{ form.group_name.help_text }}<p>
                                 <p>{{ form.group_name.errors }}
                                    {{ form.group_name }}</p>
                            {% endif %}
                            <button type="submit" value="Save Group" class="btn btn-primary" name="group_name_button">
                                Create Group
                            </button>
                            </form>
                    {% endif %}
            </div>
        </div>
    </div>
</span>
{% endblock %}