{% extends 'base.html' %}

{% block content %}
<script type="text/javascript" src="/frontend/bower_components/d3/d3.min.js"></script>

        <body>
    <div class ="container-fluid">
        <h2> Graphs from the processed data</h4>
        <h4> Group Name : <a href="../edit_group/{{process.group_id}}">{{ process.group_name }}</a>, Processed time: {{ process.processed_time }}</h4>
        <h4> Policy Name : <a href="/policy/show/{{process.policy_id}}">{{ process.policy_name }}</a> </h4>
        {% if operations %}

                {% for operation in operations %}
                    <div class="container">
                        <h3> Filter Name : {{ operation.signal_name }}
                             {% if operation.second_signal_name != "None" %}
                                 Second Filter Name : {{ operation.second_signal_name }}
                             {% endif %}
                             Operation: {{ operation.op_name }}
                        </h3>
                        {% if operation.op_name == "exceeds" %}
                            <div>
                            <h3> The value exceeds {{ operation.cut_off_number }}. </h3>
                            <h4> The graph value is percentage, the number that exceeds the cut of number divided by total number of frames </h4>
                            </div>
                        {% endif %}
                        {% if operation.op_name == "belows" %}
                            <div>
                            <h3> The value belows {{ operation.cut_off_number }}. </h3>
                            <h4> The graph value is percentage, the number that belows the cut of number divided by total number of frames </h4>
                            </div>
                        {% endif %}
                        {% if operation.op_name == "equals" %}
                            <div>
                            <h3> The value equals {{ operation.cut_off_number }}. </h3>
                            <h4> The graph value is percentage, the number that equals the cut of number divided by total number of frames </h4>
                            </div>
                        {% endif %}

                        <div id="chart{{ forloop.counter }}"></div>
                    </div>
                {% endfor %}
        {% endif %}
    </div>
<script type="text/javascript" src="/frontend/static/js/linechart.js"></script>
<script>
signal_names = [
{% for name in signal_names %}
    "{{name}}"{% if not forloop.last %}, {% endif %}
{% endfor %}
];
op_names = [
{% for op_name in op_names %}
    "{{op_name}}"{% if not forloop.last %}, {% endif %}
{% endfor %}
];
cut_off_numbers = [
{% for op in c_numbers %}
    "{{op}}"{% if not forloop.last %}, {% endif %}
{% endfor %}
];

function graph_for_signal(name, op_name, cut_off_number, idx) {
    d3.json("{% url 'groups:get_graph_data' %}?process_id={{process.id}}&signal_name=" + name + "&op_name=" + op_name + "&cut_off_number=" + cut_off_number,
        function(error, data) {
            createLineGraph(data, '#chart' + idx, 'lineChart' + idx);
        }
    );
}

for (i = 0; i < signal_names.length; i++) {
    graph_for_signal(signal_names[i], op_names[i], cut_off_numbers[i], i + 1);
}

</script>
{% endblock %}


